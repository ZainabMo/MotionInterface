<!DOCTYPE html>
<html>
<head>
  <title>Homework 3</title>
  <link rel="stylesheet" href="style.css" />
  <!-- <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css"
    /> -->
  <!-- use directional motion but user shudnt need to shake(excessive acceleration) make sureno accidental invocation -->
  <!-- change in plane, creativity - add feedback mby?
  dont map to state (NOT if x=.. SHUD BE 
  if angle changes from 0 to greater 50(or give grace of extra degrees,
  maybe case of accidental phonedrop?),
  if has changed let them make phone straight again
   add max PLUS), but to transition/change,
   + time threshhold toprevent accident
   
   and it shud happen only once 
    whats best for the user? fwd backward? left right? wat abt for dlefthanded ppl(dont think it wud matter)
  -->
</head>
<body>
  <input id="input" type="text"/>
  <button id="undo" onclick="undo()">undo</button>
  <button id="redo" onclick="redo()">redo</button>
  <button id="request">Request for Permission</button>

  <pre class="output">result </pre>
  <script type="text/javascript" src="jquery-3.6.0.min.js"></script>

  <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" crossorigin="anonymous"></script> -->
  <script type="text/javascript">
          //Building on code snippet from https://stackoverflow.com/questions/54416318/how-to-make-a-undo-redo-function
          const UndoMementos = []
          const RedoMementos = []
          const input = document.querySelector('input')
          input.addEventListener('input', saveMemento);
          function saveMemento() {
            UndoMementos.push(input.value)
          }

          function undo() {
            RedoMementos.push(input.value)
            const lastMemento = UndoMementos.pop()
            input.value = lastMemento ? lastMemento : input.value
          }

          function redo() {
            const redoMemento = RedoMementos.pop()
            input.value = redoMemento.length > input.value.length ? redoMemento : input.value //if redo value is larger
            UndoMementos.push(input.value)
          }

    (function($) {
      $(document).ready(function() {
        if (location.protocol != "https:") {
          location.href = "https:" + window.location.href.substring(window.location.protocol.length);
        }
        function handleOrientation(event) {
            var x = event.beta; // In degree in the range [-180,180)
            var y = event.gamma; // In degree in the range [-90,90)
            output.textContent += `beta : ${x}\n`;
            output.textContent += `gamma: ${y}\n`;
            // Because we don't want to have the device upside down
            // We constrain the x value to the range [-90,90]
            if (x > 90) { x = 90 };
            if (x < -90) { x = -90 };

            // To make computation easier we shift the range of
            // x and y to [0,180]
            x += 90;
            y += 90;
        }

        window.addEventListener("deviceorientation", handleOrientation, true);

        function permission() {
            if (typeof(DeviceMotionEvent) !== "undefined" && typeof(DeviceMotionEvent.requestPermission) === "function") {
                // (optional) Do something before API request prompt.
                output.textContent = `Need to request for permission first \n`;
                DeviceMotionEvent.requestPermission()
                    .then(response => {
                        // (optional) Do something after API prompt dismissed.
                        if (response == "granted") {
                            window.addEventListener("deviceorientation", handleOrientation, true);
                        }
                    })
                    .catch(console.error);
            } else {
                alert("DeviceMotionEvent is undefined.");
            }
        }
        const btn = document.getElementById("request");
        btn.addEventListener("click", permission);

        });
      })(window.jQuery);
  </script>
</body>
</html>
